# ========== 连接跟踪优化 (针对 2G 内存 + 20万连接) ==========
net.netfilter.nf_conntrack_max = 200000
net.netfilter.nf_conntrack_buckets = 50000
net.netfilter.nf_conntrack_tcp_timeout_established = 3600
net.netfilter.nf_conntrack_tcp_timeout_syn_recv = 15
net.netfilter.nf_conntrack_udp_timeout = 10

# ========== 缓冲区与高并发优化 ==========
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
net.ipv4.tcp_rmem = 4096 87380 16777216
net.ipv4.tcp_wmem = 4096 65536 16777216
net.core.somaxconn = 4096
net.core.netdev_max_backlog = 4096
net.ipv4.tcp_syncookies = 1
net.ipv4.tcp_timestamps = 1
net.ipv4.udp_rmem_min = 8192
net.ipv4.udp_wmem_min = 8192

# ========== 拥塞控制与转发性能 (BBR) ==========
net.core.default_qdisc = fq_codel
net.ipv4.tcp_congestion_control = bbr
net.ipv4.rps_sock_flow_entries = 32768
vm.swappiness = 10
vm.vfs_cache_pressure = 50
